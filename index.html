<html>

<head>
</head>

<body>
    <h1>Example content</h1>
</body>
<script src="https://cdn.jsdelivr.net/npm/web3@latest/dist/web3.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@audius/sdk@latest/dist/sdk.min.js"></script>
<script>


    function fn() {
        return new Promise((resolve) => {
            const audiusSdk = window.audiusSdk({
                apiKey: "b93e4682ceb0196e408b128bfa8e4a927d65d23a", //objeto ApiKEY
            });
            resolve(audiusSdk)
        })
    }


    async function searchTrack(id) {
        const audiusSdk = await fn()
        const result = await audiusSdk.tracks.getTrack({ trackId: id });

        return result;
    }

    async function playMusic(id){
        const audiusSdk = await fn()
        const url = await audiusSdk.tracks.streamTrack({
            trackId: id,
        });
        console.log('URL',url)

        //REPRODUCIR AUDIO
        const audio = new Audio(url);
        // 1. Crea el elemento de audio.
        const nuevoElementoAudio = document.createElement('audio');
        nuevoElementoAudio.setAttribute('preload', 'auto');
        nuevoElementoAudio.setAttribute('src', url);
        nuevoElementoAudio.setAttribute('controls', ''); // Agrega el atributo "controls".

        // 2. Obtén una referencia al cuerpo (body) del documento.
        const body = document.body;

        // 3. Inserta el elemento de audio al principio del cuerpo.
        body.insertBefore(nuevoElementoAudio, body.firstChild);
    }

    function main(){
        searchTrack('8zJYQp9').then((result)=>{
            console.log(result)
            console.log(`<li>${result.trackId}</li>`)

        });
        playMusic('8zJYQp9').then((result)=>{
            console.log(result)
        })
    }
    main();


    /*cuando se resuelva la promesa entonces se mostrara el resultado del metodo fn(). Esto
    puede ser envuelto dentro de una funcion
    fn().then((result)=>{
        console.log(result)
    })
        .catch((error) => {
        console.error("Error al obtener datos:", error);
    })*/



    /*

async function searchTrack(id) {
    doAsyncStuffWithPromises(1, 3)
        .then(result = console.log(result))


    const audiusSdk = await fn();
    const result = await audiusSdk.tracks.getTrack({ trackId: id });
    console.log(result, "Dentro del metodo!");
}
searchTrack("D7KyD");



async function test() {
    const audiusSdk = await fn();
    const url = await audiusSdk.tracks.streamTrack({
        trackId: "D7KyD",
    });

    //REPRODUCIR AUDIO
    const audio = new Audio(url);
    console.log(audio)
    // 1. Crea el elemento de audio.
    const nuevoElementoAudio = document.createElement('audio');
    nuevoElementoAudio.setAttribute('preload', 'auto');
    nuevoElementoAudio.setAttribute('src', 'https://discoveryprovider2.audius.co/v1/tracks/D7KyD/stream');
    nuevoElementoAudio.setAttribute('controls', ''); // Agrega el atributo "controls".

    // 2. Obtén una referencia al cuerpo (body) del documento.
    const body = document.body;

    // 3. Inserta el elemento de audio al principio del cuerpo.
    body.insertBefore(nuevoElementoAudio, body.firstChild);

}
test();
*/
</script>

</html>
